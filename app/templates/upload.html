{% extends "base.html" %}

{% block title %}{{ form.form_id }} - Dokumente hochladen{% endblock %}

{% block content %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">Formulare</a></li>
        <li class="breadcrumb-item active">{{ form.form_id }} - Upload</li>
    </ol>
</nav>

<h2>{{ form.form_id }} &mdash; {{ form.form_title }}</h2>
<p class="text-muted">
    Laden Sie die PDF-Dokumente hoch, aus denen das Formular ausgefüllt werden soll
    (z.B. Arztbriefe, Befundberichte, Entlassungsbriefe).
</p>

<form id="uploadForm" action="/form/{{ form.form_id }}/process" method="post"
      enctype="multipart/form-data">

    <div class="upload-zone mb-3" id="dropZone">
        <i class="bi bi-cloud-arrow-up"></i>
        <p class="mt-2 mb-1 fw-bold">PDF-Dateien hierher ziehen</p>
        <p class="text-muted mb-0">oder klicken zum Auswählen</p>
        <input type="file" name="files" id="fileInput" multiple accept=".pdf"
               class="d-none">
    </div>

    <div id="fileList" class="mb-3"></div>

    <div class="alert alert-info d-flex align-items-center gap-2" role="alert">
        <i class="bi bi-info-circle"></i>
        <span>Unterstützte Formate: PDF (auch gescannte Dokumente mit OCR-Erkennung).
        Maximal 10 Dateien, je max. 50 MB.</span>
    </div>

    <div id="processingInfo" class="d-none text-center my-4">
        <div class="spinner-border processing-spinner text-primary" role="status">
            <span class="visually-hidden">Verarbeitung...</span>
        </div>
        <p class="mt-3 fw-bold">Dokumente werden verarbeitet...</p>
        <p class="text-muted">
            Text wird extrahiert und von der KI analysiert. Dies kann je nach
            Dokumentgröße 1-3 Minuten dauern.
        </p>
    </div>

    <button type="submit" class="btn btn-primary btn-lg" id="submitBtn" disabled>
        <i class="bi bi-cpu"></i> Verarbeiten
    </button>
</form>
{% endblock %}

{% block scripts %}
<script src="/static/js/upload.js"></script>
{% endblock %}
